# DOCX to Markdown Converter

This Node.js script converts a DOCX file to a Markdown (`.md`) file. 

It uses the `mammoth` library to extract the content from the DOCX file, along with `turndown` to convert the HTML content generated by Mammoth into Markdown. 

Images embedded in the DOCX file are extracted and saved as individual image files, and tables are converted from HTML to Markdown format.

## Features

- Converts text and headings from DOCX to Markdown.
- Extracts images from DOCX files and saves them locally as `.png`, `.jpeg`, or `.jpg` files.
- Converts HTML tables into Markdown format.
- Processes base64-encoded images found in the DOCX file and replaces them with Markdown image links to local files.

## Prerequisites

Before running the script, you need to have the following installed:

- [Node.js](https://nodejs.org/) (version 12 or higher)
- npm (Node package manager)

## Installation

1. Clone this repository or download the source files.
2. Navigate to the project directory in your terminal.
3. Install the necessary dependencies:

   ```bash
   npm install mammoth turndown turndown-plugin-gfm
   ```

## Usage

1. Place your DOCX file in the desired location.

2. Open the script and modify the following paths:

    - inputDocx: The path to the input DOCX file.
    - outputMarkdown: The path where you want to save the output Markdown file.
    - imagesDirectory: The directory where the extracted images should be saved.

3. Run the script:

   ```bash
   node convertDocxToMarkdown.js
   ```

## Example Paths

```javascript
const inputDocx = 'docs/example.docx';              // Path to the DOCX file
const outputMarkdown = 'output/example.md';         // Path to save the Markdown file
const imagesDirectory = 'output/images';            // Directory to save extracted images
```

## How it Works

1. DOCX Conversion: The script uses mammoth to convert the DOCX content into HTML. This allows the text, headings, and other structural elements to be parsed and handled properly.

2. Image Handling: The script looks for base64-encoded images in the DOCX file (processed by Mammoth). It extracts these images, decodes the base64 data, and saves them as individual image files in a specified directory. The Markdown output references these saved images using relative paths.

3. Table Conversion: Tables in the DOCX file are converted from their HTML format into Markdown tables. This ensures that tables are rendered properly in Markdown.

## Example Output

Given a DOCX file containing images, tables, and headings, the script will:

- Save images to a specified directory (e.g., output/images/image_1.png).

- Generate a Markdown file with content like:

```markdown
# Heading 1

Heading 1 content

## Heading 1 with picture

Below I have picture

![Image](images/image_1.png)

Above I have picture

## Heading 2 with table

| Cell1 | Cell2 | Cell3 |
| ---   | ---   | ---   |
| Cell4 | Cell5 | Cell6 |
| Cell7 | Cell8 | Cell9 |

## Heading 2 after table

Heading 2 after table content
```

## Notes

- Ensure that the paths for your DOCX file, output Markdown file, and images directory are correct before running the script.
- The script handles images in PNG, JPEG, and JPG formats.
- If your DOCX file contains other elements (e.g., complex formatting), they might not be fully supported by the conversion

## Dependencies

- [Mammoth](https://github.com/mwilliamson/mammoth.js) – Used for extracting content from DOCX files.
- [Turndown](https://github.com/domchristie/turndown) – Converts HTML into Markdown.
- [Turndown Plugin GFM](https://github.com/domchristie/turndown-plugin-gfm) – Adds GitHub Flavored Markdown support.

## License

This project is open-source and available under the [MIT License](https://opensource.org/licenses/MIT).
